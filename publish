#!/usr/bin/env coffee

sys = require 'sys'
exec = require('child_process').exec
fs = require 'fs'
path = require 'path'

dist = path.join __dirname, 'dist'
compileCoffee = 'coffee --compile --output ' + dist + ' ' + __dirname

copyFile = (src, dest)->
  fs.createReadStream(src).pipe(fs.createWriteStream(dest))

copyPackage = ->
  pkg = path.join __dirname, 'package.json' 
  distPkg = path.join dist, 'package.json'
  copyFile pkg, distPkg

coffeeCompiled = (error, stdout, stderr)->
  if !error
    success = 
      """
      \n
      \  Coffee scripts compiled successfully.
      \n
      """
    console.log success

    copyPackage()

child = exec compileCoffee, coffeeCompiled